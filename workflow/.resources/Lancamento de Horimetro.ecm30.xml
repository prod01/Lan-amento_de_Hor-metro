<list>
  <ProcessDefinition>
    <processDefinitionPK>
      <companyId>1</companyId>
      <processId>LancamentoDeHorimetro</processId>
    </processDefinitionPK>
    <processDescription>Lançamento de Horímetro</processDescription>
    <instruction></instruction>
    <active>true</active>
    <publicProcess>false</publicProcess>
    <volumeId>Default</volumeId>
    <categoryId>Manutenção</categoryId>
    <managerEngineAllocationId>Papel</managerEngineAllocationId>
    <managerEngineAllocationConfiguration>&lt;AssignmentController&gt;&lt;Role&gt;GestorOSE&lt;/Role&gt;&lt;/AssignmentController&gt;</managerEngineAllocationConfiguration>
    <snapshotFrequency>0</snapshotFrequency>
    <baseDay>0</baseDay>
    <baseMonth>0</baseMonth>
    <periodId>Default</periodId>
    <uniqueCardVersion>true</uniqueCardVersion>
    <keyWord></keyWord>
    <complementsLevel>1</complementsLevel>
    <notifyRequisitionerComplements>true</notifyRequisitionerComplements>
    <notifyManagerComplements>false</notifyManagerComplements>
    <deadlineTime>0</deadlineTime>
    <warningDeadlineTime>0</warningDeadlineTime>
    <notifyAuthorityComplements>true</notifyAuthorityComplements>
  </ProcessDefinition>
  <ProcessDefinitionVersion>
    <processDefinitionVersionPK>
      <companyId>1</companyId>
      <processId>Lançamento de Horímetro</processId>
      <version>54</version>
    </processDefinitionVersionPK>
    <versionDescription></versionDescription>
    <formId>0</formId>
    <editionMode>true</editionMode>
    <updateAttachmentsVersion>false</updateAttachmentsVersion>
    <controlsAttachmentsSecurity>false</controlsAttachmentsSecurity>
    <active>true</active>
    <blockedVersion>false</blockedVersion>
    <counterSign>false</counterSign>
    <openInstances>0</openInstances>
    <bpmnVersion>2</bpmnVersion>
    <processStates/>
    <favorito>false</favorito>
    <inheritFormSecurity>false</inheritFormSecurity>
    <mobileReady>true</mobileReady>
  </ProcessDefinitionVersion>
  <list>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>4</sequence>
      </processStatePK>
      <stateName>Start</stateName>
      <stateDescription>Start</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId>Grupo</engineAllocationId>
      <engineAllocationConfiguration>&lt;AssignmentController&gt;&lt;Group&gt;OSELancamentoHorimetro&lt;/Group&gt;&lt;/AssignmentController&gt;</engineAllocationConfiguration>
      <selectColleague>1</selectColleague>
      <initialState>true</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>3600</allowanceAuthorityTime>
      <frequenceAuthorityTime>3600</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>100</positionX>
      <positionY>66</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>10</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>7</sequence>
      </processStatePK>
      <stateName>Resolve Erros de Integração</stateName>
      <stateDescription>Resolve Erros de Integração</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId>Pool Papel</engineAllocationId>
      <engineAllocationConfiguration>&lt;AssignmentController&gt;&lt;Role&gt;admin&lt;/Role&gt;&lt;/AssignmentController&gt;</engineAllocationConfiguration>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>3600</allowanceAuthorityTime>
      <frequenceAuthorityTime>3600</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>220</positionX>
      <positionY>194</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>80</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>0</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>13</sequence>
      </processStatePK>
      <stateName>Integra RM</stateName>
      <stateDescription>Integra RM</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>false</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>0</allowanceAuthorityTime>
      <frequenceAuthorityTime>0</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>220</positionX>
      <positionY>56</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>82</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>1</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>17</sequence>
      </processStatePK>
      <stateName>Intermediate</stateName>
      <stateDescription>Intermediate</stateDescription>
      <instruction>Evento intermediário do processo</instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <engineAllocationConfiguration></engineAllocationConfiguration>
      <selectColleague>0</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>1</allowanceAuthorityTime>
      <frequenceAuthorityTime>1</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>297</positionX>
      <positionY>98</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>43</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <parentSequence>13</parentSequence>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>15</sequence>
      </processStatePK>
      <stateName>End</stateName>
      <stateDescription>End</stateDescription>
      <instruction>Atividade final do processo</instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <engineAllocationConfiguration></engineAllocationConfiguration>
      <selectColleague>0</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>0</allowanceAuthorityTime>
      <frequenceAuthorityTime>1</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>390</positionX>
      <positionY>66</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>6</stateType>
      <bpmnType>60</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
    </ProcessState>
  </list>
  <list/>
  <list>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <linkSequence>14</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>4</initialStateSequence>
      <finalStateSequence>13</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <linkSequence>16</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>13</initialStateSequence>
      <finalStateSequence>15</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <linkSequence>18</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>17</initialStateSequence>
      <finalStateSequence>7</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <linkSequence>19</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>7</initialStateSequence>
      <finalStateSequence>13</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
  </list>
  <list/>
  <list>
    <WorkflowProcessEvent>
      <workflowProcessEventPK>
        <companyId>1</companyId>
        <eventId>servicetask13</eventId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
      </workflowProcessEventPK>
      <eventDescription>function servicetask13(attempt, message,Integer) {

	var nomeDataserver = &quot;MntHistIndicadorData&quot;
	log.info(&quot;nomeDataserver: &quot;+nomeDataserver)
	
	var user = DatasetFactory.getDataset(&quot;ds_connector&quot;, null, null, null);
	log.info(&quot;user: &quot;+user)
	
	var usuario = user.getValue(0, &quot;INTEGRADOR&quot;)
	log.info(&quot;usuario: &quot;+usuario)
	var senha = user.getValue(0, &quot;SENHA&quot;)
	log.info(&quot;senha: &quot;+senha)
	var email = user.getValue(0, &quot;EMAIL&quot;)
	log.info(&quot;email: &quot;+email)
	
	var USUARIOLOGADO = hAPI.getCardValue(&quot;USUARIOLOGADO&quot;);
	var primeiraLetra = USUARIOLOGADO.substring(0, 1).toUpperCase();
	var restoDaString = USUARIOLOGADO.slice(1);
	var USUARIOLOGADO = primeiraLetra + restoDaString;
	log.info(&quot;USUARIOLOGADO: &quot;+USUARIOLOGADO);
	
	var contexto = &quot;codcoligada=1;codusuario=&quot;+USUARIOLOGADO+&quot;;codsistema=O&quot;
		log.info(&quot;contexto: &quot;+contexto)
		
	var authService = getWebService(usuario, senha)
	log.info(&quot;authService: &quot;+authService)
	
	var IDMAQUINA = hAPI.getCardValue(&quot;IDMAQUINA&quot;)
	log.info(&quot;IDMAQUINA: &quot;+IDMAQUINA)
	
	var DATACOLETA = hAPI.getCardValue(&quot;DATACOLETA&quot;)
	log.info(&quot;DATALANCAMENTO: &quot;+DATACOLETA)
    
    		var date = DATACOLETA.split(&quot; &quot;)[0];
			log.info(&quot;data&quot;+date);
		    var hora = DATACOLETA.split(&quot; &quot;)[1];
			log.info(&quot;hora&quot; +hora);
	
           var d = date.split(&quot;/&quot;)[0];
    	   var m = date.split(&quot;/&quot;)[1];
    	   var a = date.split(&quot;/&quot;)[2];
    
    		
    		var dia = a + &quot;-&quot; + m + &quot;-&quot; + d;

    		var h = hora.split(&quot;:&quot;)[0];
    		var m = hora.split(&quot;:&quot;)[1];

    		var hor = h + &quot;:&quot; + m + &quot;:00&quot;;
    		
    		var datafull = dia + &quot;T&quot;  + hor;
            log.info(&quot;data da medicao&quot;+datafull)
            
            
	
	var VALORMEDIDOR1 = parseFloat(hAPI.getCardValue(&quot;VALORMEDIDOR1&quot;));
	log.info(&quot;VALORMEDIDOR1: &quot;+VALORMEDIDOR1);
	var VALORMEDIDOR5 = parseFloat(hAPI.getCardValue(&quot;VALORMEDIDOR5&quot;));
	log.info(&quot;VALORMEDIDOR5: &quot;+VALORMEDIDOR5);
	
	
	try{
		var c1_2 = DatasetFactory.createConstraint(&quot;IDOBJOF&quot;, IDMAQUINA, IDMAQUINA, ConstraintType.MUST);
		var constraints_2 = new Array(c1_2);
		var dataset_2 = DatasetFactory.getDataset(&quot;ds_OSE_HistoricoIndicadorDeUso&quot;, null, constraints_2, null);
		var horimetroAtual = dataset_2.getValue(0, &quot;VALORMEDIDOR1&quot;);
		var horimetroAcumulado = dataset_2.getValue(0, &quot;VALORACUMULADO1&quot;);
		var combustivelAtual = dataset_2.getValue(0, &quot;VALORMEDIDOR5&quot;) == &quot;null&quot; ? 0 : dataset_2.getValue(0, &quot;VALORMEDIDOR5&quot;);
		var combustivelAcumulado = dataset_2.getValue(0, &quot;VALORACUMULADO5&quot;) == &quot;null&quot; ? 0 : dataset_2.getValue(0, &quot;VALORACUMULADO5&quot;);
		var dataLancamento = dataset_2.getValue(0, &quot;DATALANCAMENTO&quot;).split(&quot; &quot;)[0];
	} catch (e) {
		log.error(e);
	}

	if ( parseFloat(horimetroAtual) &lt; parseFloat(VALORMEDIDOR1) ){
		horimetroAcumulado = parseFloat(horimetroAcumulado) + (parseFloat(VALORMEDIDOR1) - parseFloat(horimetroAtual));
	}
	if ( parseFloat(combustivelAtual) &lt; parseFloat(VALORMEDIDOR5) ){
		combustivelAcumulado = parseFloat(combustivelAcumulado) + (parseFloat(VALORMEDIDOR5) - parseFloat(combustivelAtual));
	}
	
	// Obtém a data atual
	var dataAtual = new Date();
	
	// Extrai os componentes da data
	var ano = dataAtual.getFullYear();
	var mes = (dataAtual.getMonth() + 1) &lt; 10 ? &quot;0&quot;+(dataAtual.getMonth() + 1) : (dataAtual.getMonth() + 1); // Os meses são indexados a partir de 0
	var dia = (dataAtual.getDate()) &lt; 10 ? &quot;0&quot;+(dataAtual.getDate()) : (dataAtual.getDate());
            
	var dataColeta = hAPI.getCardValue(&quot;DATACOLETA&quot;).split(&quot; &quot;)[0]
	dataColeta = new Date(dataColeta.split(&quot;/&quot;)[2], dataColeta.split(&quot;/&quot;)[1]-1, dataColeta.split(&quot;/&quot;)[0]);

	if ( ( new Date(ano, mes-1, dia).toISOString().split(&apos;T&apos;)[0] &gt; dataLancamento ) ||
					( dataLancamento == dataColeta.toISOString().split(&apos;T&apos;)[0] &amp;&amp;
							String(VALORMEDIDOR1).replace(&quot;.&quot;, &quot;,&quot;) != horimetroAtual.replace(&quot;.&quot;, &quot;,&quot;) ) ){
    //xml que envia as informaçoes para o RM    
	var xml = 
		&quot; &lt;NewDataSet&gt;&quot;+
				&quot;&lt;OFHistIndicador&gt;&quot;+
			    	&quot;&lt;CODCOLIGADA&gt;1&lt;/CODCOLIGADA&gt;&quot;+
				    &quot;&lt;IDOBJOF&gt;&quot; +IDMAQUINA+ &quot;&lt;/IDOBJOF&gt;&quot;+
					&quot;&lt;IDHISTINDICADOR&gt;-1&lt;/IDHISTINDICADOR&gt;&quot;+
					&quot;&lt;DATACOLETA&gt;&quot; +datafull+ &quot;&lt;/DATACOLETA&gt;&quot;+
					&quot;&lt;CODUSUARIO&gt;&quot; +USUARIOLOGADO+ &quot;&lt;/CODUSUARIO&gt;&quot;+
					&quot;&lt;VALORMEDIDOR1&gt;&quot; +String(VALORMEDIDOR1).replace(&quot;.&quot;, &quot;,&quot;)+ &quot;&lt;/VALORMEDIDOR1&gt;&quot;+
					&quot;&lt;VALORACUMULADO1&gt;&quot; +String(horimetroAcumulado).replace(&quot;.&quot;, &quot;,&quot;)+ &quot;&lt;/VALORACUMULADO1&gt;&quot;;
	
				if (hAPI.getCardValue(&quot;USAINDICADORUSO5&quot;) == &quot;1&quot;){
					xml = xml+&quot;&lt;VALORMEDIDOR5&gt;&quot; +String(VALORMEDIDOR5).replace(&quot;.&quot;, &quot;,&quot;)+ &quot;&lt;/VALORMEDIDOR5&gt;&quot;+
					&quot;&lt;VALORACUMULADO5&gt;&quot; +String(combustivelAcumulado).replace(&quot;.&quot;, &quot;,&quot;)+ &quot;&lt;/VALORACUMULADO5&gt;&quot;;
				}
					
			xml = xml+ &quot;&lt;/OFHistIndicador&gt;&quot;+
		&quot;&lt;/NewDataSet&gt;&quot;;
			
			log.info(&quot;xml: &quot;+xml)
			log.info(&quot;teste antes : &quot;+xml);
				
	var result = new String( authService.saveRecord(nomeDataserver, xml, contexto) );
	//String DataServerName, String XML, String UserName, String UserPassword, String contexto, String emailUsuarioContexto
			
			log.info(&quot;teste depois: &quot;+result);	
			log.info(&quot;result: &quot;+result);
	} else {
		throw &quot;ERRO AO LANÇAR HORIMETRO DA MAQUINA\n\n&quot;+result.split(&quot;=&quot;)[0]+&quot;\n\n&quot;
		log.error(&quot;Não entrou no IF&quot;);
		log.error(&quot;=======================================================&quot;);
		log.error(&quot;new Date: &quot;+new Date(ano, mes-1, dia).toISOString().split(&apos;T&apos;)[0]);
		log.error(&quot;dataLancamento: &quot;+dataLancamento);
		log.error(&quot;=======================================================&quot;);
		log.error(&quot;dataLancamento: &quot;+dataLancamento);
		log.error(&quot;datacoleta: &quot;+dataColeta.toISOString().split(&apos;T&apos;)[0]);
		log.error(&quot;VALORMEDIDOR1: &quot;+String(VALORMEDIDOR1).replace(&quot;.&quot;, &quot;,&quot;));
		log.error(&quot;horimetroAtual: &quot;+horimetroAtual.replace(&quot;.&quot;, &quot;,&quot;));
		log.error(&quot;=======================================================&quot;);
	}
			
}

function getWebService(usuario, senha){
	
	var nomeServico = &quot;wsDataServer&quot;
		log.info(&quot;nomeServico: &quot;+nomeServico)
		
	var caminhoServico = &quot;com.totvs.WsDataServer&quot;
		log.info(&quot;caminhoServico: &quot;+caminhoServico)
		
	var dataServerService = ServiceManager.getServiceInstance(nomeServico);
	log.info(&quot;dataServerService: &quot;+dataServerService)
	
	if (dataServerService == null){
		throw &quot;Erro ao encontrar serviço!&quot;;
	}
	
	var locator = dataServerService.instantiate(caminhoServico);
	log.info(&quot;locator: &quot;+locator)

	if (locator == null){
		throw &quot;Erro ao instanciar serviço!&quot;;
	}
	
	var service = locator.getRMIwsDataServer();
	log.info(&quot;service: &quot;+service)

	if (service == null){
		throw &quot;Erro instancia incorreta ou com problemas!&quot;;
	}
	
	var serviceHelper = dataServerService.getBean();
	log.info(&quot;serviceHelper: &quot;+serviceHelper)

	if (serviceHelper == null){
		throw &quot;Erro no serviço de autenticação!&quot;;
	}
	
	var authService = serviceHelper.getBasicAuthenticatedClient(service, &quot;com.totvs.IwsDataServer&quot;, usuario, senha)
	log.info(&quot;authService: &quot;+authService)

	if (authService == null){
		throw &quot;Erro ao autenticar dataserver!&quot;;
	}
	
	return authService;
	
}
</eventDescription>
    </WorkflowProcessEvent>
  </list>
  <list/>
  <list>
    <SwimLane>
      <color>FFFFFF</color>
      <height>290</height>
      <width>471</width>
      <positionX>10</positionX>
      <positionY>10</positionY>
      <stateName>Lançamento de Horímetro</stateName>
      <type>1</type>
      <parentSequence>0</parentSequence>
      <swimLanePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>1</sequence>
      </swimLanePK>
    </SwimLane>
    <SwimLane>
      <color>92B689</color>
      <height>145</height>
      <width>441</width>
      <positionX>40</positionX>
      <positionY>10</positionY>
      <stateName>PCM</stateName>
      <type>2</type>
      <parentSequence>1</parentSequence>
      <swimLanePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>2</sequence>
      </swimLanePK>
    </SwimLane>
    <SwimLane>
      <color>8EB4C1</color>
      <height>145</height>
      <width>441</width>
      <positionX>40</positionX>
      <positionY>155</positionY>
      <stateName>Suporte T.I</stateName>
      <type>2</type>
      <parentSequence>1</parentSequence>
      <swimLanePK>
        <companyId>1</companyId>
        <processId>LancamentoDeHorimetro</processId>
        <version>1</version>
        <sequence>3</sequence>
      </swimLanePK>
    </SwimLane>
  </list>
  <list/>
  <list/>
  <list/>
  <list/>
  <list/>
  <list/>
  <list>
    <ProcessStateService>
      <companyId>1</companyId>
      <processId>LancamentoDeHorimetro</processId>
      <version>1</version>
      <sequence>13</sequence>
      <attempts>0</attempts>
      <sucessFullMessage>Integration performed successfully</sucessFullMessage>
      <serviceName></serviceName>
      <frequency>1</frequency>
      <frequencyType>0</frequencyType>
    </ProcessStateService>
  </list>
  <list/>
  <list/>
  <list/>
  <list/>
</list>